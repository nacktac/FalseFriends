<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Daily False Friends</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app" class="game-container">
    <h1>Daily False Friends</h1>
    
    <div class="daily-info">
      <p>Today's puzzle will reset in <span class="reset-time">{{ nextResetTime }}</span></p>
      <div class="streak-container">
        <div class="streak-box">
          <div class="streak-number">{{ streakData.currentStreak }}</div>
          <div class="streak-label">Current<br>Streak</div>
        </div>
        <div class="streak-box">
          <div class="streak-number">{{ streakData.maxStreak }}</div>
          <div class="streak-label">Max<br>Streak</div>
        </div>
      </div>
    </div>
    
    <div class="instructions">
      <p>Find the odd one out from each row. The four odd-ones-out will form their own theme! Each row has its own hidden theme that will be revealed when you solve the puzzle.</p>
    </div>
    
    <div v-if="gameState === 'playing' && currentBoard">
      <div v-for="(row, rowIndex) in currentBoard.rows" :key="rowIndex" class="row">
        <div class="clues">
          <div 
            v-for="(clue, clueIndex) in row.clues" 
            :key="clueIndex"
            class="clue-tile"
            :class="{ 
              selected: isClueSelected(clue),
              returning: recentlyReturnedClues.includes(clue)
            }"
            @click="selectClue(clue, rowIndex)"
            v-if="!isClueSelected(clue)"
          >
            {{ clue }}
          </div>
        </div>
      </div>
      
      <div class="selection-tray">
        <div v-if="selectedClues.length === 0" class="selection-placeholder">
          Select the odd one out from each row...
        </div>
        <div 
          v-for="(clue, index) in selectedClues" 
          :key="index" 
          class="selected-clue"
          :class="'row-' + selectedCluesRowIndices[index]"
          @click="deselectClue(index)"
        >
          {{ clue }}
        </div>
      </div>
      
      <button 
        class="submit-btn"
        :disabled="selectedClues.length !== 4 || isProcessing"
        @click="checkAnswer"
      >
        Submit Answer
      </button>
    </div>
    
    <div v-if="gameState === 'failure'" class="result failure">
      <h2>Not quite right!</h2>
      <p>Returning incorrect selections to their rows. Try again!</p>
    </div>
    
    <div v-if="gameState === 'success' && currentBoard" class="result success">
      <h2>Congratulations!</h2>
      <p>You solved today's puzzle!</p>
      
      <div class="revealed-themes">
        <div v-for="(row, index) in currentBoard.rows" :key="index" class="theme-reveal">
          <div class="theme-name">Row {{index + 1}}: {{ row.theme }}</div>
          <div class="theme-clues">{{ getRowThemeClues(index) }}</div>
        </div>
        
        <div class="theme-reveal">
          <div class="theme-name">False Friends: {{ currentBoard.falseFriendTheme }}</div>
          <div class="theme-clues">{{ selectedClues.join(', ') }}</div>
        </div>
      </div>
      
      <div class="share-section">
        <p>Come back tomorrow for a new puzzle!</p>
        <div class="streak-message" v-if="streakData.currentStreak > 1">
          <p>You're on a {{ streakData.currentStreak }}-day streak! Keep it going!</p>
        </div>
        <button class="share-btn" onclick="sharePuzzle()">Share Result</button>
      </div>
    </div>
  </div>

  <script src="gameboards.js"></script>
  <script src="app.js"></script>
  <script>
    // Simple share function
    function sharePuzzle() {
      // Get streak information from the Vue app
      const streakInfo = document.querySelector('#app').__vue_app__.config.globalProperties.$streakData;
      const currentStreak = streakInfo ? streakInfo.currentStreak : 0;
      
      let text = `I solved today's False Friends puzzle!`;
      if (currentStreak > 1) {
        text += ` ${currentStreak} day streak! ðŸ”¥`;
      }
      text += ` Can you figure out the connections? Play at [your-website-url]`;
      
      if (navigator.share) {
        navigator.share({
          title: 'Daily False Friends',
          text: text
        })
        .catch(error => {
          console.log('Error sharing:', error);
          fallbackShare(text);
        });
      } else {
        fallbackShare(text);
      }
    }
    
    function fallbackShare(text) {
      // Create a temporary input
      const input = document.createElement('textarea');
      input.value = text;
      document.body.appendChild(input);
      input.select();
      document.execCommand('copy');
      document.body.removeChild(input);
      
      alert('Result copied to clipboard!');
    }
  </script>
</body>
</html>
